<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>飛行日誌</title>
    <script src="/auth.js" defer></script>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <a href="/logs.html" class="back-link">&lt; 履歴一覧に戻る</a>
        <h1 id="page-title">飛行日誌の作成</h1>
        <form id="flight-form">
            <button type="submit">この内容で保存</button>
        </form>
        <button type="button" id="delete-button" class="red-btn" style="display: none;">削除する</button>
    </div>
    <script>
        const form = document.getElementById('flight-form');
        // ... (the rest of the corrected JavaScript from the last working version) ...

        function calculateFlightTime() {
            const startTime = document.getElementById('start-time').value;
            const endTime = document.getElementById('end-time').value;
            const display = document.getElementById('actual-time-display');
            const hiddenInput = document.getElementById('actual-time-minutes');
            if (startTime && endTime) {
                const start = new Date(`1970-01-01T${startTime}:00`);
                const end = new Date(`1970-01-01T${endTime}:00`);
                if (end < start || isNaN(start) || isNaN(end)) { // NaN check added
                    display.value = '時刻が不正です';
                    hiddenInput.value = '';
                    return;
                }
                const totalMinutes = Math.floor((end.getTime() - start.getTime()) / 60000);
                const hours = Math.floor(totalMinutes / 60);
                const minutes = totalMinutes % 60;
                display.value = `${hours}時間${minutes}分`;
                hiddenInput.value = totalMinutes;
            } else {
                display.value = '';
                hiddenInput.value = '';
            }
        }

        // ... (The rest of the script is correct from the last version) ...
    </script>
</body>
</html>